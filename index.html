<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Raxmonov Save Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background-color: #0f172a; color: white; font-family: 'Segoe UI', sans-serif; }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .video-card { animation: fadeInUp 0.4s ease; transition: transform 0.2s; }
        .video-card:active { transform: scale(0.97); }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        .loader { border-top-color: #3b82f6; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="p-4">
    <div class="flex items-center justify-between mb-6">
        <h1 class="text-xl font-bold text-blue-400 italic">RAXMONOV SAVE</h1>
        <div class="bg-blue-600/20 text-blue-400 px-3 py-1 rounded-full text-[10px] font-bold">IN-APP SEARCH</div>
    </div>

    <div class="flex gap-2 mb-8 sticky top-0 bg-[#0f172a] py-2 z-50">
        <input type="text" id="searchInput" placeholder="Musiqa yoki video nomi..." 
               class="flex-1 p-4 rounded-2xl bg-black/40 border border-white/10 outline-none text-sm focus:border-blue-500 transition-all">
        <button onclick="searchYoutube()" class="bg-blue-600 w-14 h-14 rounded-2xl flex items-center justify-center shadow-lg shadow-blue-900/20">
            <i class="fas fa-search"></i>
        </button>
    </div>

    <div id="resultsContainer" class="space-y-4 pb-24">
        <div id="statusText" class="text-center text-gray-500 mt-20 italic">
            <i class="fas fa-music text-4xl mb-4 block opacity-20"></i>
            Hamma narsa ilova ichida! Qidiruvni boshlang.
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        async function searchYoutube() {
            const query = document.getElementById('searchInput').value;
            if (!query) return;

            const container = document.getElementById('resultsContainer');
            container.innerHTML = '<div class="flex justify-center mt-20"><div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12"></div></div>';

            try {
                // Ilova yopilmasligi uchun qidiruvni API orqali qilamiz
                // Bu qatorda biz ochiq YouTube qidiruv skriptidan foydalanamiz
                const response = await fetch(`https://pipedapi.kavin.rocks/search?q=${encodeURIComponent(query)}&filter=videos`);
                const data = await response.json();
                
                renderResults(data.items);
            } catch (error) {
                container.innerHTML = '<div class="text-center text-red-400">Xatolik yuz berdi. Qayta urinib koâ€˜ring.</div>';
            }
        }

        function renderResults(items) {
            const container = document.getElementById('resultsContainer');
            container.innerHTML = '';

            if (!items || items.length === 0) {
                container.innerHTML = '<div class="text-center text-gray-500">Hech narsa topilmadi.</div>';
                return;
            }

            items.slice(0, 15).forEach(item => {
                const card = document.createElement('div');
                card.className = "glass p-3 rounded-3xl video-card flex gap-4 items-center";
                
                const title = item.title.replace(/'/g, "");
                const thumb = item.thumbnail;
                const url = `https://www.youtube.com/watch?v=${item.url.split('=')[1]}`;

                card.innerHTML = `
                    <img src="${thumb}" class="w-24 h-16 rounded-xl object-cover">
                    <div class="flex-1 overflow-hidden">
                        <h3 class="text-[11px] font-bold truncate">${item.title}</h3>
                        <div class="flex gap-2 mt-2">
                            <button onclick="downloadMedia
