<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Top Foydalanuvchilar Reytingi</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #0f172a; color: white; display: flex; justify-content: center; padding: 20px; }
        .container { width: 100%; max-width: 400px; background: #1e293b; padding: 20px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.5); }
        h2 { text-align: center; color: #38bdf8; }
        .leaderboard { margin-top: 20px; }
        .user-card { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #334155; transition: 0.3s; }
        .user-card:hover { background: #334155; border-radius: 8px; }
        .rank { font-weight: bold; width: 30px; color: #94a3b8; }
        .name { flex-grow: 1; margin-left: 10px; }
        .score { font-weight: bold; color: #f59e0b; }
        .top-3 { color: #fbbf24; font-size: 1.1em; }
    </style>
</head>
<body>

<div class="container">
    <h2>üèÜ Top Reyting</h2>
    <div id="leaderboard" class="leaderboard">
        <p style="text-align:center;">Yuklanmoqda...</p>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, onValue, query, orderByChild, limitToLast } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    // Sizning Firebase konfiguratsiyangiz
    const firebaseConfig = {
        apiKey: "AIzaSyBc7tUey3q6hGZjWxisJo701-G4NbyD9zI",
        authDomain: "gen-lang-client-0228947349.firebaseapp.com",
        databaseURL: "https://gen-lang-client-0228947349-default-rtdb.firebaseio.com",
        projectId: "gen-lang-client-0228947349",
        storageBucket: "gen-lang-client-0228947349.firebasestorage.app",
        messagingSenderId: "253793341504",
        appId: "1:253793341504:web:709752258000dab44fcfa5"
    };

    // Firebase-ni ishga tushirish
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // Reytingni olish (masalan, 'users' tugunidan 'score' bo'yicha)
    const usersRef = query(ref(db, 'users'), orderByChild('score'), limitToLast(10));

    onValue(usersRef, (snapshot) => {
        const leaderboardDiv = document.getElementById('leaderboard');
        leaderboardDiv.innerHTML = ''; // Tozalash
        
        let users = [];
        snapshot.forEach((childSnapshot) => {
            users.push(childSnapshot.val());
        });

        // Firebase limitToLast ishlatganda o'sish tartibida beradi, bizga kamayish tartibi kerak
        users.reverse();

        users.forEach((user, index) => {
            const rank = index + 1;
            const rankClass = rank <= 3 ? 'top-3' : '';
            
            leaderboardDiv.innerHTML += `
                <div class="user-card ${rankClass}">
                    <span class="rank">#${rank}</span>
                    <span class="name">${user.username || 'Noma\'lum'}</span>
                    <span class="score">${user.score.toLocaleString()} ball</span>
                </div>
            `;
        });
    });
</script>

</body>
</html>
